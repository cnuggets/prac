define([],function(){"use strict";function n(){t!=window.location.href&&(t=window.location.href,v.fire("statechange"))}var i={},r={statechange:[],routeload:[]},t="",v={init:function(t){return void 0===t&&(t={}),window.addEventListener?(window.addEventListener("popstate",n,!1),window.addEventListener("hashchange",n,!1)):(window.attachEvent("popstate",n),window.attachEvent("onhashchange",n)),!1!==t.loadCurrentRouteOnStateChange&&v.on("statechange",function(){v.loadCurrentRoute()}),!1!==t.fireInitialStateChange&&v.fire("statechange"),v},routes:{},activeRoute:{},registerRoutes:function(t){for(var n in t)t.hasOwnProperty(n)&&(v.routes[n]=t[n]);return v},on:function(t,n){return void 0===r[t]&&(r[t]=[]),r[t].push(n),v},fire:function(t){if(r[t])for(var n=Array.prototype.slice.call(arguments,1),e=0;e<r[t].length;e++)r[t][e].apply(v,n);return v},off:function(t,n){return!r[t]||-1!==(n=r[t].indexOf(n))&&r[t].splice(n,1),v},loadCurrentRoute:function(){for(var t in v.routes)if(v.routes.hasOwnProperty(t)){var n=v.routes[t];if(v.testRoute(n)){v.activeRoute.active=!1,n.active=!0,v.activeRoute=n,require([n.moduleId],function(t){n.active&&v.fire("routeload",t,v.routeArguments(n,window.location.href))});break}}return v},urlPath:function(t){if(void 0!==i[t])return i[t];var n=t.split("/"),e="/"+n.splice(3,n.length-3).join("/"),r=e.split(/[\?#]/)[0],n=e.indexOf("#");return-1!==n&&("#/"===(n=e.substring(n).split("?")[0]).substring(0,2)?r=n.substring(1):"#!/"===n.substring(0,3)&&(r=n.substring(2))),i[t]=r},testRoute:function(t,n){n=v.urlPath(n||window.location.href);if(t.path===n||"*"===t.path)return!0;if(t.path instanceof RegExp)return t.path.test(n);if(-1===t.path.indexOf("*")&&-1===t.path.indexOf(":"))return!1;var e,r=n.split("/"),i=t.path.split("/");if(r.length!==i.length)return!1;for(e in i)if(i.hasOwnProperty(e)){var o=i[e];if(o!==r[e]&&"*"!==o&&":"!==o.charAt(0))return!1}return!0},routeArguments:function(t,n){t=t||v.activeRoute,n=n||window.location.href;var e,r,i={},o=v.urlPath(n).split("/"),a=[];for(e in a=t&&t.path&&!(t.path instanceof RegExp)?t.path.split("/"):a)!a.hasOwnProperty(e)||":"===(r=a[e]).charAt(0)&&(i[r.substring(1)]=o[e]);var u=n.indexOf("?"),s="";-1===u||-1!==(f=(s=n.substring(u)).indexOf("#"))&&(s=s.substring(0,f));var f,h=n.indexOf("#/"),t=n.indexOf("#!/");-1===h&&-1===t||(f="",-1!==(u=(f=-1!==h?n.substring(h):n.substring(t)).indexOf("?"))&&(s=f.substring(u)));var c,p,d,l=s.substring(1).split("&");for(c in l=1===l.length&&""===l[0]?[]:l)l.hasOwnProperty(c)&&(i[(p=l[c].split("="))[0]]=p.splice(1,p.length-1).join("="));for(d in i){var g=i[d];"true"===g?i[d]=!0:"false"===g?i[d]=!1:isNaN(g)||""===g||"0"===g.charAt(0)?i[d]=decodeURIComponent(g):i[d]=+g}return i}};return v});
//# sourceMappingURL=router-0.8.0.js.map